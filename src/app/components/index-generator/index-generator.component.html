<div class="container" dir="rtl">
  <div class="header">
    <h1>×”×¤×§×ª ××¤×ª×—×•×ª ×œ×¡×¤×¨×™× ×ª×•×¨× ×™×™×</h1>
    <p class="subtitle">×™×¦×¨×• ××¤×ª×—×•×ª ××•×˜×•××˜×™×™× ×œ×¡×¤×¨×›× ×‘×××¦×¢×•×ª ×‘×™× ×” ××œ××›×•×ª×™×ª</p>
  </div>

  <div class="content">
    <!-- Step 1: Index Type Selection -->
    <section class="step" *ngIf="!generatedIndex()">
      <h2>×©×œ×‘ ×: ×‘×—×™×¨×ª ×¡×•×’ ×”××¤×ª×—</h2>
      <div class="index-type-buttons">
        <!-- for() -->
        <button *ngFor="let type of indexTypes" [class.selected]="selectedIndexType() === type.value"
          (click)="onIndexTypeChange(type.value)" class="index-type-btn">
          {{ type.label }}
        </button>
      </div>
    </section>

    <!-- Step 2: File Upload -->
    <section class="step" *ngIf="!generatedIndex()">
      <h2>×©×œ×‘ ×‘: ×”×¢×œ××ª ×”×§×•×‘×¥</h2>
      <div class="file-upload">
        <label for="file-input" class="file-label">
          <span *ngIf="!selectedFile()" class="upload-icon">ğŸ“„</span>
          <span *ngIf="!selectedFile()" class="upload-text">
            ×‘×—×¨×• ×§×•×‘×¥ PDF ××• ×’×¨×¨×• ××•×ª×• ×œ×›××Ÿ
          </span>
          <span *ngIf="selectedFile()" class="selected-file">
            âœ“ {{ selectedFile()!.name }}
          </span>
        </label>
        <input #fileInput type="file" id="file-input" accept=".pdf" (change)="onFileSelected($event)" hidden />
      </div>
    </section>

    <section class="step" *ngIf="!generatedIndex()">
      <h2>×˜×•×•×— ×¢××•×“×™× (××•×¤×¦×™×•× ×œ×™)</h2>

      <div class="page-range">
        <div class="page-input">
          <label>××¢××•×“</label>
          <input type="number" min="1" [ngModel]="fromPage()" (ngModelChange)="fromPage.set($event)" />
        </div>

        <div class="page-input">
          <label>×¢×“ ×¢××•×“</label>
          <input type="number" min="1" [ngModel]="toPage()" (ngModelChange)="toPage.set($event)" />
        </div>
      </div>
    </section>

    <!-- Generate Button -->
    <section class="step" *ngIf="!generatedIndex()">
      <button [disabled]="!isReady() || isLoading()" (click)="generateIndex()" class="generate-btn">
        <span *ngIf="!isLoading()">×”×¤×§ ××¤×ª×—</span>
        <span *ngIf="isLoading()">××¢×‘×“...</span>
      </button>
    </section>

    <!-- Error Message -->
    <div *ngIf="errorMessage()" class="error-message">
      âš ï¸ {{ errorMessage() }}
    </div>

    <!-- Results -->
    <section *ngIf="generatedIndex()" class="results-section">
      <div class="results-header">
        <h2>×ª×•×¦××•×ª - ××¤×ª×— {{ selectedIndexType() }}</h2>
        <button (click)="reset()" class="reset-btn">×—×–×•×¨ ×œ×ª×—×™×œ×”</button>
      </div>

      <!-- Preview -->
      <div class="preview">
        <h3>×ª×¦×•×’×” ××§×“×™××” ({{ generatedIndex()!.previewEntries.length }} ×¤×¨×™×˜×™× ×¨××©×•× ×™× ××ª×•×š {{
          generatedIndex()!.data.entries.length }})</h3>
        <ul class="entry-list">
          <li *ngFor="let entry of generatedIndex()!.previewEntries" class="entry-item">
            <span class="term">{{ entry.term }}</span>
            <span *ngIf="entry.pageNumbers.length > 0" class="pages">
              (×¢××•×“: {{ entry.pageNumbers.join(', ') }})
            </span>
            <p *ngIf="entry.description" class="description">
              {{ entry.description }}
            </p>
          </li>
        </ul>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button (click)="downloadAsWord()" class="download-btn">
          â¬‡ï¸ ×”×•×¨×“ ×§×•×‘×¥ Word
        </button>
        <button (click)="copyToClipboard()" class="copy-btn">
          ğŸ“‹ ×”×¢×ª×§ ×œ×ª×™×§×™×™×”
        </button>
      </div>

      <!-- Full List -->
      <details class="full-list">
        <summary>×”×¦×’ ××ª ×”××¤×ª×— ×”××œ× ({{ generatedIndex()!.data.entries.length }} ×¤×¨×™×˜×™×)</summary>
        <ul class="entry-list">
          <li *ngFor="let entry of generatedIndex()!.data.entries" class="entry-item">
            <span class="term">{{ entry.term }}</span>
            <span *ngIf="entry.pageNumbers.length > 0" class="pages">
              (×¢××•×“: {{ entry.pageNumbers.join(', ') }})
            </span>
            <p *ngIf="entry.description" class="description">
              {{ entry.description }}
            </p>
          </li>
        </ul>
      </details>
    </section>
  </div>
</div>